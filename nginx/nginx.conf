events {}

http {
    # Redirect HTTP to HTTPS (still using weak SSL settings)
    server {
        listen 80;
        server_name 0.0.0.0;

        # Redirect all traffic to HTTPS
        location / {
            return 301 https://192.168.1.8$request_uri;
        }
    }

    # HTTPS configuration with vulnerable SSL settings
    server {
        listen 443 ssl;
        server_name 192.168.1.8;  # You can use your actual server IP here

        # Weak SSL/TLS certificates (self-signed or weak)
        ssl_certificate /etc/nginx/certs/nginx-selfsigned.crt;
        ssl_certificate_key /etc/nginx/certs/nginx-selfsigned.key;

        # Vulnerable SSL/TLS settings (weak protocols, weak ciphers)
        ssl_protocols SSLv3 TLSv1 TLSv1.1;  # Old, insecure protocols
        ssl_ciphers RC4-SHA:RC4-MD5:EXP-RC4-MD5:EXP-DES-CBC-SHA:DES-CBC-SHA:AES128-SHA:AES256-SHA:3DES:NULL-MD5;  # Weak ciphers, including weak ones like RC4 and DES
        ssl_prefer_server_ciphers off;  # Weak preference order (allows weaker client ciphers)

        # Disable secure renegotiation (vulnerable to attack)
        ssl_renegotiation off;
        
        location / {
            # If your files are in /app directory inside the container
            root /app/public;
            index index.html index.htm;
        }
    }
}